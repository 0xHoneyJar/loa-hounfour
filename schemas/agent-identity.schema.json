{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://schemas.0xhoneyjar.com/loa-hounfour/7.3.0/agent-identity",
  "additionalProperties": false,
  "x-cross-field-validated": true,
  "description": "Canonical agent identity with capability-scoped trust (v6.0.0, BREAKING).",
  "type": "object",
  "required": [
    "agent_id",
    "display_name",
    "agent_type",
    "capabilities",
    "trust_scopes",
    "delegation_authority",
    "max_delegation_depth",
    "governance_weight",
    "contract_version"
  ],
  "properties": {
    "agent_id": {
      "pattern": "^[a-z][a-z0-9_-]{2,63}$",
      "description": "Unique agent identifier (lowercase, 3-64 chars).",
      "type": "string"
    },
    "display_name": {
      "minLength": 1,
      "maxLength": 128,
      "description": "Human-readable agent display name.",
      "type": "string"
    },
    "agent_type": {
      "$id": "AgentType",
      "description": "Classification of agent type in the protocol.",
      "anyOf": [
        {
          "const": "model",
          "type": "string"
        },
        {
          "const": "orchestrator",
          "type": "string"
        },
        {
          "const": "human",
          "type": "string"
        },
        {
          "const": "service",
          "type": "string"
        },
        {
          "const": "composite",
          "type": "string"
        }
      ]
    },
    "capabilities": {
      "minItems": 1,
      "description": "Non-empty list of agent capabilities.",
      "type": "array",
      "items": {
        "minLength": 1,
        "type": "string"
      }
    },
    "trust_scopes": {
      "$id": "CapabilityScopedTrust",
      "additionalProperties": false,
      "description": "Per-capability-scope trust levels with default fallback (v6.0.0, BREAKING).",
      "type": "object",
      "required": [
        "scopes",
        "default_level"
      ],
      "properties": {
        "scopes": {
          "additionalProperties": false,
          "description": "Per-scope trust levels. Missing scopes fall back to default_level.",
          "type": "object",
          "properties": {
            "billing": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            },
            "governance": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            },
            "inference": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            },
            "delegation": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            },
            "audit": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            },
            "composition": {
              "$id": "TrustLevel",
              "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
              "anyOf": [
                {
                  "const": "untrusted",
                  "type": "string"
                },
                {
                  "const": "basic",
                  "type": "string"
                },
                {
                  "const": "verified",
                  "type": "string"
                },
                {
                  "const": "trusted",
                  "type": "string"
                },
                {
                  "const": "sovereign",
                  "type": "string"
                }
              ]
            }
          }
        },
        "default_level": {
          "$id": "TrustLevel",
          "description": "Trust level assigned to an agent. Forms a total order from untrusted to sovereign.",
          "anyOf": [
            {
              "const": "untrusted",
              "type": "string"
            },
            {
              "const": "basic",
              "type": "string"
            },
            {
              "const": "verified",
              "type": "string"
            },
            {
              "const": "trusted",
              "type": "string"
            },
            {
              "const": "sovereign",
              "type": "string"
            }
          ]
        }
      }
    },
    "delegation_authority": {
      "description": "Permissions this agent may delegate. Requires delegation scope >= verified.",
      "type": "array",
      "items": {
        "minLength": 1,
        "type": "string"
      }
    },
    "max_delegation_depth": {
      "minimum": 0,
      "maximum": 10,
      "description": "Maximum delegation chain depth this agent may create.",
      "type": "integer"
    },
    "governance_weight": {
      "minimum": 0,
      "maximum": 1,
      "description": "Voting weight in governance proposals (0-1).",
      "type": "number"
    },
    "metadata": {
      "description": "Extensible metadata key-value store.",
      "type": "object",
      "patternProperties": {
        "^(.*)$": {}
      }
    },
    "contract_version": {
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Protocol contract version.",
      "type": "string"
    }
  },
  "$comment": "contract_version=7.3.0, min_supported=6.0.0"
}
