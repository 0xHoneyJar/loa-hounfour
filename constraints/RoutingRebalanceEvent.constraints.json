{
  "$schema": "https://loa-hounfour.dev/schemas/constraint-file.json",
  "schema_id": "RoutingRebalanceEvent",
  "origin": "genesis",
  "constraints": [
    {
      "id": "rebalance-compositions-differ",
      "expression": "before_composition_id != after_composition_id",
      "severity": "error",
      "type_signature": {
        "before_composition_id": "string",
        "after_composition_id": "string"
      },
      "fields": [
        "before_composition_id",
        "after_composition_id"
      ],
      "message": "Before and after composition must differ (a rebalance should change something)."
    },
    {
      "id": "rebalance-window-ordered",
      "expression": "performance_window_start == null || performance_window_end == null || is_after(performance_window_end, performance_window_start)",
      "severity": "error",
      "type_signature": {
        "performance_window_start": "string | undefined",
        "performance_window_end": "string | undefined"
      },
      "fields": [
        "performance_window_start",
        "performance_window_end"
      ],
      "message": "If both window dates are present, end must be after start."
    }
  ]
}
